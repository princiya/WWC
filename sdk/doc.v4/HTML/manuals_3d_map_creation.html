<!DOCTYPE HTML>
<html>
<head>
   <title>3D Map Creation</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <style type="text/css">
     body { margin: 0px; background: #FFFFFF; }
   </style>
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "manuals_3d_map_creation.html");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body>


<table style="width:100%; border:none; border-spacing:0px; padding:5px; background:#FFCC99">
  <tr style="vertical-align:middle">
    <td style="text-align:left">
      <h1 class="p_Heading1"><span class="f_Heading1">3D Map Creation</span></h1>

    </td>
    <td style="text-align:right">
     <a href="docm_legal_information.html">Top</a>&nbsp;
     <a href="manuals_configuration_and_tracking_dat.html">Previous</a>&nbsp;
     <a href="manuals_programming_guide_voice.html">Next</a>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table style="width:100%;border:none;border-spacing:0px"><tr style="vertical-align:top"><td style="text-align:left;padding:5px">
<p class="p_Body"><span class="f_Body">Besides using the standalone Metaio* Toolbox, you can use the </span><span class="f_CodeExample"><a href="pxctrackerutils.html" class="topiclink">PXC[M]TrackerUtils</a></span><span class="f_Body"> interface to create 3D maps programmatically. This is useful in some cases. For example, when the background surrounding an object is cluttered, instant 3D tracking does not perform optimally. You can pre-create a 3D map with the object is on a less cluttered background. </span></p>
<p class="p_InternalHeading"><span class="f_InternalHeading">Map creation</span></p>
<p class="p_Body"><span class="f_Body">A map may be created interactively using a live camera stream. During map creation, the camera is moved around the stationary object and the relative object pose is determined automatically. </span></p>
<p class="p_InternalHeading"><span class="f_Body">Use the following steps to create a 3D map:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 14px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the</span><span class="f_TableText2"> </span><span class="f_CodeExample"><a href="start3dmapcreation_pxctrackerutils.html" class="topiclink">Start3DMapCreation</a></span><span class="f_TableText2"> function to start the 3D map creation.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 14px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_TableText2">During 3D map creation, you need to continue to feed the frames (using the </span><span class="f_CodeExample"><a href="pxcsensemanager.html" class="topiclink">PXC[M]SenseManger</a></span><span class="f_TableText2"> pipeline) to the module. </span></td></tr></table></div><p class="p_InternalHeading"><img src="tip.png" width="24" height="24" alt="" style="width:24px;height:24px;border:none" /><span class="f_Body">When a depth stream is available, the 3D map may be successfully created in a single frame. Without the depth data, a “baseline” horizontal movement is necessary to establish the parallax for depth calculations. The exact distance of the horizontal movement depends on the size of the object.</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 14px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_TableText2">Use the </span><span class="f_CodeExample"><a href="querynumberfeaturepoints_pxctrackerutils.html" class="topiclink">QueryNumberFeaturePoints</a></span><span class="f_TableText2"> function to check for the number of feature points, and optionally the </span><span class="f_CodeExample"><a href="queryfeaturepoints_pxctrackerutils.html" class="topiclink">QueryFeaturePoints</a></span><span class="f_TableText2"> function to visualize the detected feature points. Repeat this process until the number of detected feature points meets certain threshold.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 14px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_TableText2">Use the </span><span class="f_CodeExample"><a href="save3dmap_pxctrackerutils.html" class="topiclink">Save3DMap</a></span><span class="f_TableText2"> function to save the 3D map.</span></td></tr></table></div><p class="p_InternalHeading"><span class="f_InternalHeading">Map Extension</span></p>
<p class="p_Body"><span class="f_Body">Map extension can be used to augment existing object maps with additional information. Additional features allow for more robust tracking, especially if the object has changed significantly. For example, a doll figure may be represented by a generic 3D model. If you can change the doll’s hair, clothes, etc. then extend the generic model to incorporate the new appearance, you can improve tracking quality. In another usage model, the object must be fixed with respect to the environment, such as a book on a shelf. &nbsp;By extending the book map to include the environmental features of the shelf, the tracking accuracy and robustness is increased.</span></p>
<p class="p_InternalHeading"><span class="f_Body">Use the following steps to extend a 3D map:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="load3dmap_pxctrackerutils.html" class="topiclink">Load3DMap</a></span><span class="f_Body"> function to load an existing 3D map.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="start3dmapextension_pxctrackerutils.html" class="topiclink">Start3DMapExtension</a></span><span class="f_Body"> function to start the map extension process.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">During 3D map extension, you need to continue to feed the frames (using the </span><span class="f_CodeExample"><a href="pxcsensemanager.html" class="topiclink">PXC[M]SenseManger</a></span><span class="f_Body"> pipeline) to the module. </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="querynumberfeaturepoints_pxctrackerutils.html" class="topiclink">QueryNumberFeaturePoints</a></span><span class="f_Body"> function to check for the number of feature points, and optionally the </span><span class="f_CodeExample"><a href="queryfeaturepoints_pxctrackerutils.html" class="topiclink">QueryFeaturePoints</a></span><span class="f_Body"> function to visualize the detected feature points. Repeat this process until the number of detected feature points meets certain threshold.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="save3dmap_pxctrackerutils.html" class="topiclink">Save3DMap</a></span><span class="f_Body"> function to save the 3D map.</span></td></tr></table></div><p class="p_InternalHeading"><span class="f_InternalHeading">Map alignment</span></p>
<p class="p_InternalHeading"><span class="f_Body">During interactive map creation, the object pose is determined algorithmically. However, this pose (object rotation and origin) may not accurately represent the physical object. The pose may be aligned to specially designed markers, which then set the rotation and origin for the map. A pose created from a figurine can be moved from the torso to between the feet, with the Y axis pointing up along the figurine’s height. &nbsp;Alignment is a dynamic process and is only complete when the relationship between the object features and the marker is determined.</span></p>
<p class="p_InternalHeading"><span class="f_Body">Use the following steps to start the 3D map alignment process:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="load3dmap_pxctrackerutils.html" class="topiclink">Load3DMap</a></span><span class="f_Body"> function to load an existing 3D map.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="start3dmapalignment_pxctrackerutils.html" class="topiclink">Start3DMapAlignment</a></span><span class="f_Body"> function to start the alignment process.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">During 3D map alignment process, you need to continue to feed the frames (using the </span><span class="f_CodeExample"><a href="pxcsensemanager.html" class="topiclink">PXC[M]SenseManger</a></span><span class="f_Body"> pipeline) to the module. </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="is3dmapalignmentcomplete_pxctrackerutils.html" class="topiclink">Is3DMapAlignmentComplete</a></span><span class="f_Body"> function to check if alignment is completed. Repeat the process until the alignment completes.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="save3dmap_pxctrackerutils.html" class="topiclink">Save3DMap</a></span><span class="f_Body"> function to save the 3D map.</span></td></tr></table></div><p class="p_InternalHeading"><span class="f_InternalHeading">Camera Calibration</span></p>
<p class="p_Body"><span class="f_Body">By calibrating the camera, the positional accuracy of tracked objects is increased. &nbsp;A default calibration is performed at initialization time using pre-stored camera parameters. However, active calibration may still improve the accuracy. To perform calibration, the camera needs to see several distinct views of the calibration marker (the same as the map alignment markers). Calibration parameters can be loaded and saved to a file, or as a binary blob in memory that is loaded and saved externally. It is not necessary to wait for calibration to reach 100% before saving, however the calibration quality is not be as accurate.</span></p>
<p class="p_InternalHeading"><span class="f_Body">Use the following steps to start the 3D map alignment process:</span></p>
<div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="startcameracalibration_pxctrackerutils.html" class="topiclink">StartCameraCalibration</a></span><span class="f_Body"> function to start the calibration process.</span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="querycalibrationprogress_pxctrackerutils.html" class="topiclink">QueryCalibrationProgress</a></span><span class="f_Body"> function to check for process. You need to continue to feed the frames (using the </span><span class="f_CodeExample"><a href="pxcsensemanager.html" class="topiclink">PXC[M]SenseManger</a></span><span class="f_Body"> pipeline) to the module. </span></td></tr></table></div><div style="text-align: left; text-indent: 0px; padding: 0px 0px 0px 0px; margin: 7px 0px 7px 0px;"><table border="0" cellpadding="0" cellspacing="0" style="border:none;border-spacing:0px;padding:0px;line-height: normal;"><tr valign="baseline" style="vertical-align:baseline"><td style="border:none;width:17px"><span style="font-size:11pt; font-family: 'Arial Unicode MS','Lucida Sans Unicode','Arial';color:#000000;">&#8226;</span></td><td style="border:none"><span class="f_Body">Use the </span><span class="f_CodeExample"><a href="savecameraparameterstofile_pxctrackerutils.html" class="topiclink">SaveCameraParametersToFile</a></span><span class="f_Body"> function to save the camera parameters.</span></td></tr></table></div><p class="p_InternalHeading"><span class="f_InternalHeading">Tips for Camera Alignment and Calibration</span></p>
<p class="p_InternalHeading"><span class="f_Body">360° maps of an object are not typically usable when the objects are smaller than a desk or table. To solve this issue, two 180° maps can be created from the left and right sides of an object. Each map is then aligned to the same marker, which ensures that the pose of the object is correct regardless of which map is currently tracking.</span></p>
<p class="p_InternalHeading"><span class="f_InternalHeading">&nbsp;</span></p>

</td></tr></table>

</body>
</html>
